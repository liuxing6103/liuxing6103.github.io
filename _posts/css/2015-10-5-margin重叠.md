---
layout: post
category: "css"
---

# margin重叠

相邻块级元素会依据一套规则共享垂直方向的外边距。

## 由于margin重叠导致的常见问题

- 给子元素设置margin-top，结果父元素产生了margin-top，而子元素和父元素并没有产生距离。
- 两元素相邻，上面元素的margin-bottom与下面元素的margin-top没有加在一起。

第一个问题看起来就是个bug，而第二个我认为实际上并不算是问题，应该算是个规则，只要按照下面的相邻元素叠加规则计算应有的边距就不会显得多困惑了。

## 叠加规则

虽然消除重叠是最好的实践方法，不过margin叠加的规则有必要了解一下。

### rule 1：全部都为正值，取最大者

如下面代码效果所示，两条线之间的距离为30和20中较大的那个也就是30。

    <!DOCTYPE html>
    <html>
    <head>
        <title>float</title>
        <meta charset="utf-8"/>
        <style>
            *{
                padding: 0;
                margin: 0;
            }
            .wrapper{
                background: #cccccc;
                height: 100px;
            }
            .line{
                margin-bottom: 30px;
    
            }
            .line2{
                margin-top: 20px;
            }
        </style>
    </head>
        <div class="wrapper"></div>
        <hr class="line"/>
        <hr class="line2"/>
        <div class="wrapper"></div>
    </html>

### rule 2：不全是正值，则都取绝对值，然后用正值减去最大值

经过叠加，两条线的距离为30-20=10px。

    .line{
        margin-bottom: 30px;

    }
    .line2{
        margin-top: -20px;
    }

### rule 3：没有正值，则都取绝对值，然后用0减去最大值

经过叠加，下面的wrapper覆盖上面的wrapper30px。通过DevTool也可以看到两条线之间的距离也是30px。

    .line{
        margin-bottom: -30px;

    }
    .line2{
        margin-top: -20px;
    }

## 消除叠加

回顾刚刚的常见问题，如果问题2能够依据规则解除困惑的话，那么实际上margin重叠的影响在于问题1。

### method1：BFC

还记得BFC么？其中有一条规则，**BFC就是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面的元素。**
正如上面规则所示。生成BFC是解决问题1的一个解决方案。

回顾一下生成BFC的条件。

- 根元素
- float属性不为none
- position为absolute或fixed
- display为inline-block, table-cell, table-caption, flex, inline-flex
- overflow不为visible

### method2：父子不接触

父元素使用垂直方向的padding，使父子元素不接触即可。

### method3：改变子元素属性

- 子元素postion:absolute:
- 子元素加float属性;
- 子元素：display:inline-block;


