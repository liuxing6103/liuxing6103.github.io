---
layout: post
category: "other"
---

关于代理的一些事

#代理服务器学习

代理服务器，顾名思义就是代替客户端去完成一些请求。代理服务器有很多用处。

- 访问外网，访问教育网
- 合理选用代理服务器可以提高访问速度（合理二字一会儿解释）
- 隐藏用户真实ip
- 为内网提高访问外部网络的功能，还可以设置防火墙
- 节省ip开销
- 请求跨域资源

##为什么说合理情况下

其实使用代理是绕路的，因为路由协议已经选了最优的网络。但是代理服务器可以提供缓存服务，就像你的浏览器缓存无限扩大，所以有时候用起来显得很快。

##一个小实验

使用nodejs，请求跨域资源：

--|
  |-- app.html
  |-- server.js(我们想要的资源)
  |-- proxy.js(我们使用的代理服务器)

其实很简单，如下。

app.html



server.js

```
require("http").createServer(function(req ,res){
    res.end("hello proxy");
}).listen(3002)
```

proxy.js

```
/**
 * Created by shaomingquan on 15/8/12.
 */
var http = require("http");
var fs = require("fs");
http.createServer(function(req ,res){
    var url = req.url;
    console.log(url)
    if(url == "/"){
        res.end(fs.readFileSync("./app.html"));
    }else{
        console.log(0)
        http.request({
            host : "localhost",
            port : 3002
        } ,function(_res){
            _res.on("data" ,function(data){
                res.end(data);
            })
            _res.on("error" ,function(err){
                console.log(err);
            })
        }).end()
    }
}).listen(3000);
```

在terminal下面输入node proxy.js，将有一个运行在prot3000的服务器，再运行node server.js这时会有一个运行在port3002的服务器。在浏览器输入localhost:3000，前端想要拿到3002端口的返回怎么办呢？只需向localhost:3000/(any)，发送请求这时port3000的服务器会向port3002的服务器发送一个请求，然后将结果交给port3000的response返回。这样就完成了一次代理的过程。

这个算是最核心的原理，那么在实际使用中会有什么问题呢？

##代理服务器实战

